<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <!-- Primary SEO Meta Tags -->
    <title>{% block title %}FunList.ai - Discover Fun Events Near You{% endblock %}</title>
    <meta name="description" content="{% block description %}Discover fun community events near you with FunList.ai. AI-powered event discovery platform featuring local festivals, concerts, food events, and activities with fun ratings.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}events near me, local events, community events, festivals, concerts, activities, event discovery, fun events, {{ 'Olympia events' if request.endpoint == 'map' else 'Washington events' }}{% endblock %}">
    <meta name="author" content="FunList.ai">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.description() }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ url_for('static', filename='images/Have-Fun-FunList.ai-home.jpeg', _external=True) }}{% endblock %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="FunList.ai">
    <meta property="og:locale" content="en_US">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{{ request.url }}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ self.og_title() }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ self.og_description() }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}{{ self.og_image() }}{% endblock %}">
    <meta name="twitter:site" content="@funlistai">
    <meta name="twitter:creator" content="@funlistai">

    <!-- Additional SEO -->
    <meta name="theme-color" content="#007bff">
    <link rel="canonical" href="{% block canonical %}{{ request.url }}{% endblock %}">

    <!-- Enhanced Structured Data for LLM Knowledge Extraction -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "@id": "{{ url_for('index', _external=True) }}#website",
          "name": "FunList.ai",
          "alternateName": ["FunList", "Fun List AI"],
          "url": "{{ url_for('index', _external=True) }}",
          "description": "AI-powered community event discovery platform using proprietary Funalytics scoring to help families and individuals find engaging local events in Washington State",
          "inLanguage": "en-US",
          "potentialAction": {
            "@type": "SearchAction",
            "target": {
              "@type": "EntryPoint",
              "urlTemplate": "{{ url_for('map', _external=True) }}?q={search_term_string}"
            },
            "query-input": "required name=search_term_string"
          },
          "publisher": {
            "@id": "{{ url_for('index', _external=True) }}#organization"
          }
        },
        {
          "@type": "Organization",
          "@id": "{{ url_for('index', _external=True) }}#organization",
          "name": "FunList.ai",
          "alternateName": ["FunList", "Fun List AI"],
          "url": "{{ url_for('index', _external=True) }}",
          "logo": {
            "@type": "ImageObject",
            "url": "{{ url_for('static', filename='images/logo.png', _external=True) }}",
            "width": 600,
            "height": 200
          },
          "description": "AI-powered community event discovery platform using proprietary Funalytics scoring to help families and individuals find engaging local events",
          "foundingDate": "2024",
          "industry": ["Event Discovery Technology", "Community Platforms", "AI-Powered Recommendations"],
          "serviceType": "Community Event Discovery Platform",
          "areaServed": {
            "@type": "State",
            "name": "Washington",
            "containedInPlace": {
              "@type": "Country", 
              "name": "United States"
            }
          },
          "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "availableLanguage": "English",
            "serviceArea": "Washington State"
          },
          "sameAs": [
            "https://www.facebook.com/funlistai",
            "https://www.instagram.com/funlistai",
            "https://www.tiktok.com/@funlistai"
          ],
          "address": {
            "@type": "PostalAddress",
            "addressLocality": "Olympia",
            "addressRegion": "WA", 
            "addressCountry": "US"
          },
          "knowsAbout": [
            "Community Event Discovery",
            "Family-Friendly Activities", 
            "AI Event Scoring",
            "Local Entertainment",
            "Washington State Events",
            "Event Recommendation Systems",
            "Funalytics Scoring",
            "CommunityVibe Metrics",
            "FamilyFun Ratings"
          ]
        },
        {
          "@type": "FAQPage",
          "@id": "{{ url_for('index', _external=True) }}#faq",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "What is FunList.ai and how does it work?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "FunList.ai is an AI-powered community event discovery platform that helps families and individuals find engaging local events. We use our proprietary Funalytics scoring system that rates events on CommunityVibe (sense of togetherness and local flavor) and FamilyFun (suitability for families and children) metrics on a 1-10 scale."
              }
            },
            {
              "@type": "Question", 
              "name": "How does the Funalytics scoring system work?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Funalytics is our breakthrough AI scoring methodology that evaluates events across two key dimensions: CommunityVibe (0-10 scale measuring sense of togetherness, local flavor, and inclusivity) and FamilyFun (0-10 scale evaluating suitability for families and children). The overall fun rating combines these metrics to help you quickly identify the most enjoyable events."
              }
            },
            {
              "@type": "Question",
              "name": "What types of events can I find on FunList.ai?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "FunList.ai features community events across Washington State including festivals, concerts, food events, family activities, educational workshops, arts and culture events, sports activities, and seasonal celebrations. All events are curated with our AI-powered fun rating system."
              }
            },
            {
              "@type": "Question",
              "name": "How do I find events near me?",
              "acceptedAnswer": {
                "@type": "Answer", 
                "text": "Use our interactive map feature or browse events by location. Search by city, state, or zip code, and filter results by category, date, and fun rating. Our AI system provides personalized recommendations based on your interests."
              }
            },
            {
              "@type": "Question",
              "name": "Can I submit my own events to FunList.ai?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes! Event organizers can submit community events for free. Each event is evaluated using our Funalytics scoring system and reviewed for community relevance and family-friendliness before being featured."
              }
            }
          ]
        }
      ]
    }
    </script>

    <!-- LLM-Optimized Knowledge Extraction Meta -->
    <meta property="funlist:platform_type" content="AI-powered community event discovery">
    <meta property="funlist:scoring_system" content="Funalytics - CommunityVibe and FamilyFun metrics">
    <meta property="funlist:target_audience" content="families, individuals, community organizers">
    <meta property="funlist:coverage_area" content="Washington State, Pacific Northwest">
    <meta property="funlist:primary_features" content="AI event recommendations, interactive mapping, community-focused curation">
    
    <!-- Enhanced Knowledge Graph -->
    <meta property="article:publisher" content="FunList.ai">
    <meta property="article:author" content="FunList.ai Team">
    <meta name="application-name" content="FunList.ai">
    <meta name="msapplication-TileColor" content="#007bff">
    <meta name="theme-color" content="#007bff">

    {% block structured_data %}{% endblock %}

    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com https://*.cdnjs.cloudflare.com https://www.googletagmanager.com https://www.google-analytics.com https: data:; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com https://*.cdnjs.cloudflare.com https://fonts.googleapis.com https://maxcdn.bootstrapcdn.com https:; font-src 'self' data: https://fonts.gstatic.com https://cdnjs.cloudflare.com https://*.cdnjs.cloudflare.com https://maxcdn.bootstrapcdn.com https:; connect-src 'self' https://www.google-analytics.com https://www.googletagmanager.com https: wss:; img-src 'self' data: https: http: blob:; frame-src 'self' https://www.google.com https:; worker-src 'self' blob:;">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}">
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>

    {% block head %}{% endblock %}

    <!-- Custom CSS with cache-busting -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}?v={{ range(1, 10000) | random }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/ai_portal.css') }}">

    <style>
        .cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #f8f9fa;
            padding: 20px 15px;
            text-align: center;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.15);
            z-index: 1048;
            max-height: 200px;
            overflow-y: auto;
        }
        .cookie-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            justify-content: center;
        }
        .cookie-content p {
            margin: 0;
            display: block;
            font-size: 14px;
            line-height: 1.4;
            max-width: 600px;
        }
        .cookie-content a {
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
        }
        .cookie-content a:hover {
            text-decoration: underline;
        }
        .cookie-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 0;
        }
        .cookie-buttons button {
            margin: 0;
            white-space: nowrap;
        }
        
        .floating-buttons-container {
            position: fixed;
            right: 20px;
            bottom: 140px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 1060;
        }
        
        @media (max-width: 768px) {
            .floating-buttons-container {
                bottom: 135px;
            }
        }
        .floating-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            transition: all 0.3s ease;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .floating-button:first-child {
            background-color: #4e66f8;
        }
        
        .floating-button:last-child {
            background-color: #28a745;
        }
        
        .floating-button:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
            transform: translateY(-3px);
        }
        
        .floating-button i {
            font-size: 16px;
        }
    </style>
</head>
<body {% if current_user.is_authenticated %}
    data-user-id="{{ current_user.id if current_user.is_authenticated else 0 }}"
    data-user-is-organizer="{{ current_user.is_organizer|lower }}"
    data-user-is-event-creator="{{ current_user.is_event_creator|lower }}"
    data-user-is-vendor="{{ current_user.is_vendor|lower }}"
{% endif %}
      data-user-is-organizer="{{ 'true' if current_user.is_authenticated and current_user.is_organizer else 'false' }}"
      data-user-is-event-creator="{{ 'true' if current_user.is_authenticated and current_user.is_event_creator else 'false' }}"
      data-new-signup="{{ new_signup|default('false') }}">
  {% include 'partials/navbar.html' %}

<main role="main" class="mt-2">
    <div class="flash-messages-container position-sticky top-0 z-3">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show m-2" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    {% block content %}{% endblock %}
</main>

  {% if new_signup %}
    {% include 'partials/post_signup_wizard.html' %}
  {% endif %}

<footer class="footer mt-5 py-4 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg col-md-3 col-sm-6 mb-4">
                <h5 class="mb-3">COMPANY</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><a href="{{ url_for('about') }}">About Us</a></li>
                    <li class="mb-2"><a href="{{ url_for('contact') }}">Contact</a></li>
                    <li class="mb-2"><a href="{{ url_for('help') }}">Help Center</a></li>
                    <li class="mb-2"><a href="#">Advertise with Us</a></li>
                </ul>
            </div>
            <div class="col-lg col-md-3 col-sm-6 mb-4">
                <h5 class="mb-3">ACCOUNT</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><a href="{{ url_for('login') }}" class="login-link">Sign In</a></li>
                    <li class="mb-2"><a href="{{ url_for('signup') }}" class="signup-link">Sign Up</a></li>
                    <li class="mb-2"><a href="{{ url_for('submit_event') }}">Add Event</a></li>
                </ul>
            </div>
            <div class="col-lg col-md-3 col-sm-6 mb-4">
                <h5 class="mb-3">LEGAL</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><a href="{{ url_for('terms') }}">Terms & Conditions</a></li>
                    <li class="mb-2"><a href="{{ url_for('privacy') }}" class="footer-link">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="col-lg col-md-3 col-sm-6 mb-4">
                <h5 class="mb-3">AI & DEVELOPERS</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><a href="{{ url_for('ai_gateway') }}">AI Gateway</a></li>
                    <li class="mb-2"><a href="{{ url_for('ai_feed_guide') }}">Feed Guide</a></li>
                    <li class="mb-2"><a href="{{ url_for('ai_policy') }}">AI Policy</a></li>
                    <li class="mb-2"><a href="{{ url_for('ai_data_license') }}">AI Data License</a></li>
                    <li class="mb-2"><a href="/.well-known/ai-policy.json" target="_blank">AI Policy JSON</a></li>
                </ul>
            </div>
            <div class="col-lg col-md-3 col-sm-6 mb-4">
                <h5 class="mb-3">NETWORK</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><a href="https://amaspc.com" target="_blank">American Marketing Alliance SPC</a></li>
                    <li class="mb-2"><a href="https://businesscalendar.ai" target="_blank">BusinessCalendar.ai</a></li>
                    <li class="mb-2"><a href="https://localmarketingtool.ai" target="_blank">LocalMarketingTool.ai</a></li>
                    <li class="mb-2"><a href="https://thurstonai.com" target="_blank">ThurstonAI</a></li>
                </ul>
            </div>
        </div>

        <!-- Social links -->
        <div class="row mt-2 mb-3">
            <div class="col-12">
                <div class="social-buttons d-flex justify-content-center mt-3">
                    <a href="https://www.facebook.com/funlistai" target="_blank" class="btn-social facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.tiktok.com/@funlistai" target="_blank" class="btn-social tiktok"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>
        </div>

        <hr class="my-3">
        <div class="row">
            <div class="col text-center">
                <p class="mb-0">Â© 2025 FunList.ai. All rights reserved | Brought to you by 
                <a href="https://americanmarketingalliance.com" target="_blank">American Marketing Alliance SPC</a></p>
            </div>
        </div>
    </div>
</footer>
{% include 'partials/floating_buttons.html' %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  var bootstrap = window.bootstrap;
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>

<script src="{{ url_for('static', filename='js/emitter.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}" defer></script>

<script>
    window.onerror = function(message, source, lineno, colno, error) {
        console.error("Global error handler caught:", message);
        if (message === "Script error." || message === "Script error") {
            console.log("Cross-origin script error detected. Check for cross-origin issues.");
            document.querySelectorAll('script[src^="https://"]').forEach(function(script) {
                if (!script.hasAttribute('crossorigin')) {
                    script.setAttribute('crossorigin', 'anonymous');
                }
            });
        } else if (error) {
            console.error("Error details:", error);
        }
        return true;
    };

    window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled promise rejection:', event.reason);
    });

    window.safeExecute = function(fn, fallback) {
        try {
            if (typeof fn === 'function') {
                return fn();
            }
        } catch (e) {
            console.error('Error executing function:', e);
            if (typeof fallback === 'function') {
                return fallback();
            }
        }
        return null;
    };
</script>

{% block scripts %}{% endblock %}
{% if current_user.is_authenticated and current_user.email == 'ryan@funlist.ai' %}
<script src="{{ url_for('static', filename='js/admin_events.js') }}"></script>
{% endif %}

{% if new_signup %}
<script src="{{ url_for('static', filename='js/post_signup_wizard.js') }}"></script>
{% endif %}

{% block extra_js %}{% endblock %}
{% include 'partials/cookie_consent.html' %}

<!-- Initialize Feather Icons -->
<script>
  feather.replace();
</script>
</body>
</html>