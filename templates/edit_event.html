{% extends 'base.html' %}

{% block title %}Edit Event{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>Edit Event</h1>

    {% if is_admin %}
    <form method="POST" enctype="multipart/form-data">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="title" class="form-label">Event Title</label>
                <input type="text" class="form-control" id="title" name="title" value="{{ event.title }}" required>
            </div>

            <div class="col-md-6 mb-3">
                <label for="category" class="form-label">Category</label>
                <select class="form-select" id="category" name="category">
                    <option value="Arts" {% if event.category == 'Arts' %}selected{% endif %}>Arts</option>
                    <option value="Music" {% if event.category == 'Music' %}selected{% endif %}>Music</option>
                    <option value="Food" {% if event.category == 'Food' %}selected{% endif %}>Food</option>
                    <option value="Sports" {% if event.category == 'Sports' %}selected{% endif %}>Sports</option>
                    <option value="Outdoors" {% if event.category == 'Outdoors' %}selected{% endif %}>Outdoors</option>
                    <option value="Education" {% if event.category == 'Education' %}selected{% endif %}>Education</option>
                    <option value="Community" {% if event.category == 'Community' %}selected{% endif %}>Community</option>
                    <option value="Technology" {% if event.category == 'Technology' %}selected{% endif %}>Technology</option>
                    <option value="Business" {% if event.category == 'Business' %}selected{% endif %}>Business</option>
                    <option value="Other" {% if event.category == 'Other' %}selected{% endif %}>Other</option>
                </select>
            </div>
        </div>

        <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description" name="description" rows="5" required>{{ event.description }}</textarea>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="location" class="form-label">Venue Name</label>
                <input type="text" class="form-control" id="location" name="location" value="{{ event.location }}" required>
            </div>

            <div class="col-md-6 mb-3">
                <label for="address" class="form-label">Street Address</label>
                <input type="text" class="form-control" id="address" name="address" value="{{ event.address }}" required>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="city" class="form-label">City</label>
                <input type="text" class="form-control" id="city" name="city" value="{{ event.city }}" required>
            </div>

            <div class="col-md-4 mb-3">
                <label for="state" class="form-label">State</label>
                <input type="text" class="form-control" id="state" name="state" value="{{ event.state }}" required>
            </div>

            <div class="col-md-4 mb-3">
                <label for="zip_code" class="form-label">ZIP Code</label>
                <input type="text" class="form-control" id="zip_code" name="zip_code" value="{{ event.zip_code }}" required>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="start_time" class="form-label">Start Time</label>
                <input type="datetime-local" class="form-control" id="start_time" name="start_time" 
                       value="{{ event.start_time.strftime('%Y-%m-%dT%H:%M') }}" required>
            </div>

            <div class="col-md-6 mb-3">
                <label for="end_time" class="form-label">End Time</label>
                <input type="datetime-local" class="form-control" id="end_time" name="end_time" 
                       value="{{ event.end_time.strftime('%Y-%m-%dT%H:%M') }}" required>
            </div>
        </div>

        <div class="mb-3">
            <label for="website" class="form-label">Event Website</label>
            <input type="url" class="form-control" id="website" name="website" value="{{ event.website }}">
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="organizer_name" class="form-label">Organizer Name</label>
                <input type="text" class="form-control" id="organizer_name" name="organizer_name" value="{{ event.organizer_name }}" required>
            </div>

            <div class="col-md-4 mb-3">
                <label for="organizer_email" class="form-label">Organizer Email</label>
                <input type="email" class="form-control" id="organizer_email" name="organizer_email" value="{{ event.organizer_email }}" required>
            </div>

            <div class="col-md-4 mb-3">
                <label for="organizer_phone" class="form-label">Organizer Phone</label>
                <input type="tel" class="form-control" id="organizer_phone" name="organizer_phone" value="{{ event.organizer_phone }}">
            </div>
        </div>

        <div class="mb-3">
            <label for="tags" class="form-label">Tags (comma separated)</label>
            <input type="text" class="form-control" id="tags" name="tags" value="{{ event.tags }}">
        </div>

        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="is_featured" name="is_featured" {% if event.is_featured %}checked{% endif %}>
            <label class="form-check-label" for="is_featured">Featured Event</label>
        </div>

        <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" name="status">
                <option value="pending" {% if event.status == 'pending' %}selected{% endif %}>Pending</option>
                <option value="approved" {% if event.status == 'approved' %}selected{% endif %}>Approved</option>
                <option value="rejected" {% if event.status == 'rejected' %}selected{% endif %}>Rejected</option>
            </select>
        </div>

        <div class="d-flex justify-content-between">
            <button type="submit" class="btn btn-primary">Update Event</button>
            <a href="{{ url_for('admin_events') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
    {% else %}
    <p>You do not have permission to edit this event.</p>
    {% endif %}
</div>
{% endblock %}