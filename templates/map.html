{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Event Map</h1>

<div id="map" style="height: 500px;"></div>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<script>
    var map = L.map('map').setView([47.0379, -122.9007], 12); // Center on Olympia, WA

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    {% for event in events %}
    L.marker([{{ event.latitude }}, {{ event.longitude }}])
        .addTo(map)
        .bindPopup("<b>{{ event.title }}</b><br>{{ event.date.strftime('%B %d, %Y at %I:%M %p') }}<br><a href='{{ url_for('event_detail', event_id=event.id) }}'>View Details</a>");
    {% endfor %}
</script>
{% endblock %}
